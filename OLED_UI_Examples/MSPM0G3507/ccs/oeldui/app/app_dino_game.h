/**
 * app_dino_game.h
 * 小恐龙游戏头文件
 * 
 * 此文件定义了小恐龙游戏的核心数据结构、枚举类型和函数接口
 * 为游戏实现提供必要的声明
 */

#ifndef _APP_DINO_GAME_H_
#define _APP_DINO_GAME_H_

// 包含必要的标准库头文件
#include <stdbool.h>  // 提供bool类型定义

// =============================================================================
// 数据结构定义
// =============================================================================

/**
 * 恐龙游戏对象结构体
 * 
 * 用于表示游戏中的物理对象（恐龙和障碍物）
 * 包含位置、尺寸和速度信息
 */
typedef struct {
    unsigned int x;        // 对象的X坐标（水平位置）
    unsigned int y;        // 对象的Y坐标（垂直位置）
    unsigned int width;    // 对象的宽度（像素）
    unsigned int height;   // 对象的高度（像素）
    unsigned int speed;    // 对象的移动速度（主要用于障碍物）
} dino_game_object_t;

// =============================================================================
// 枚举类型定义
// =============================================================================

/**
 * 恐龙状态枚举
 * 
 * 定义了恐龙可能处于的不同状态
 */
typedef enum {
    DINO_RUNNING,  // 恐龙在地面上奔跑
    DINO_JUMPING,  // 恐龙在空中跳跃
    DINO_DUCKING,  // 恐龙下蹲
    DINO_DEAD      // 恐龙死亡
} dino_state_t;

// =============================================================================
// 公共接口函数声明
// =============================================================================

/**
 * 设置单击信号函数
 * 
 * 这是游戏提供给外部调用的接口函数，
 * 用户需要在检测到单击事件时调用此函数
 * 用于控制游戏开始、恐龙跳跃或重新开始游戏
 */
void dino_game_set_click(void);

/**
 * 游戏参数初始化
 * 
 * 初始化所有游戏变量、恐龙状态和障碍物数组
 * 显示游戏开始界面
 */
void dino_game_init(void);

/**
 * 游戏主循环
 * 
 * 游戏的入口函数，包含完整的游戏循环：
 * 初始化、输入处理、更新、渲染
 */
void dino_game_loop(void);

/**
 * 处理按键输入
 * 
 * 检查用户输入标志，并根据当前游戏状态执行相应操作：
 * - 游戏准备状态：开始游戏
 * - 游戏运行状态：使恐龙跳跃
 * - 游戏结束状态：重新开始游戏
 */
void dino_game_handle_input(void);

/**
 * 更新游戏状态
 * 
 * 更新游戏的所有动态元素：
 * - 恐龙的位置和状态
 * - 障碍物的位置和生成
 * - 游戏分数
 * - 游戏难度
 * - 碰撞检测
 */
void dino_game_update(void);

/**
 * 渲染游戏画面
 * 
 * 绘制游戏的所有视觉元素：
 * - 地面
 * - 恐龙
 * - 障碍物
 * - 分数
 * - 游戏结束信息（如果游戏已结束）
 */
void dino_game_render(void);

/**
 * 碰撞检测
 * 
 * 使用矩形碰撞检测算法检查恐龙是否与任何障碍物碰撞
 * 
 * @return 如果发生碰撞返回true，否则返回false
 */
bool dino_game_check_collision(void);

/**
 * 生成障碍物
 * 
 * 随机生成小仙人掌或大仙人掌，
 * 设置其初始位置和速度，
 * 并将其添加到障碍物数组中
 */
void dino_game_generate_obstacle(void);

/**
 * 游戏结束处理
 * 
 * 手动设置游戏状态为结束，恐龙状态为死亡
 */
void dino_game_over(void);

/**
 * 设置游戏退出标志
 * 外部模块可以调用此函数来请求游戏退出
 */
void dino_game_request_exit(void);

/**
 * 检查是否有退出请求
 * @return 如果有退出请求返回true，否则返回false
 */
bool dino_game_should_exit(void);

#endif  // _APP_DINO_GAME_H_